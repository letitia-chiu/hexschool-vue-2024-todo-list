import{u as D,r,c as L,o as F,a as n,b as a,d as t,t as C,e as N,w as l,f as b,v as x,n as w,g as $,F as P,h as j,i as q}from"./index-C14HsfuV.js";import{a as H,e as d,b as g,T as _}from"./cookieHandler-SwqydL5l.js";import{u as I}from"./auth-D51qw_Xi.js";const O={id:"todoListPage",class:"bg-half"},R=t("a",{href:"#"},[t("img",{class:"logoImg_nav",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})],-1),G={class:"todo_sm"},J={class:"conatiner todoListPage vhContainer"},K={class:"todoList_Content"},Q={class:"inputBox"},W=t("i",{class:"fa fa-plus"},null,-1),X=[W],Y={class:"todoList_list"},Z={class:"todoList_tab"},tt={class:"todoList_items"},et={key:0},st={class:"todoList_item"},ot={key:0,class:"todoList_label"},nt={key:1,class:"todoList_label"},at=["onUpdate:modelValue","onChange"],lt={key:2,class:"todo_btn_group edit_btn_group"},it=["onClick"],ct=t("i",{class:"fa-solid fa-circle-check fa-lg"},null,-1),ut=[ct],rt=t("i",{class:"fa-solid fa-circle-xmark fa-lg"},null,-1),dt=[rt],_t={key:3,class:"todo_btn_group nomal_btn_group"},vt=["onClick"],ht=t("i",{class:"fa-solid fa-pen-to-square fa-lg"},null,-1),ft=[ht],pt=["onClick"],gt=t("i",{class:"fa-solid fa-trash-can fa-lg"},null,-1),mt=[gt],kt={key:1,class:"todoList_statistics"},Tt={__name:"TodoView",setup(yt){const T=D(),v=I(),y=r("all"),h=r({all:"active",todo:"",done:""}),m=e=>{Object.keys(h.value).forEach(s=>{h.value[s]=s===e?"active":""}),y.value=e},u=r([]),V=L(()=>y.value==="todo"?u.value.filter(e=>e.status===!1):y.value==="done"?u.value.filter(e=>e.status===!0):u.value),B=L(()=>u.value.filter(e=>!e.status).length);async function k(){try{const{data:e}=await g.todos.get();u.value=e.data}catch(e){d(e)}}const f=r("");async function M(){try{const e=f.value.trim();if(e.length===0)return _("warning","Todo內容不能為空白"),f.value="";await g.todos.post(e),f.value="",k(),m("all")}catch(e){d(e)}}async function U(e){try{await g.todos.toggle(e.id),e.status?_("success",`已完成：${e.content}`):_("warning",`未完成：${e.content}`)}catch(s){d(s)}}async function E(e){try{await g.todos.delete(e.id),k(),_("success",`已刪除：${e.content}`)}catch(s){d(s)}}const i=r(),p=r("");function S(e){i.value=e,p.value=e.content}async function z(e){try{if(e.content===p.value)return i.value=null;await g.todos.put(e.id,p.value),i.value=null,await k(),_("success","更新成功")}catch(s){d(s)}}async function A(){await v.logout(),_("success","您已登出"),T.push("/login")}return F(async()=>{try{await v.authCheck(),v.status||T.push("/login"),H.defaults.headers.common.Authorization=v.token,await k()}catch(e){d(e)}}),(e,s)=>(n(),a("div",O,[t("nav",null,[R,t("ul",null,[t("li",G,[t("span",null,C(N(v).user)+"的代辦",1)]),t("li",null,[t("a",{href:"#",onClick:l(A,["prevent"])},"登出")])])]),t("div",J,[t("div",K,[t("div",Q,[b(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=o=>f.value=o)},null,512),[[x,f.value]]),t("a",{href:"#",onClick:l(M,["prevent"])},X)]),t("div",Y,[t("ul",Z,[t("li",null,[t("a",{href:"#",class:w(h.value.all),onClick:s[1]||(s[1]=l(o=>m("all"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:w(h.value.todo),onClick:s[2]||(s[2]=l(o=>m("todo"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:w(h.value.done),onClick:s[3]||(s[3]=l(o=>m("done"),["prevent"]))},"已完成",2)])]),t("div",tt,[u.value.length===0?(n(),a("p",et,"目前尚無待辦事項")):$("",!0),t("ul",st,[(n(!0),a(P,null,j(V.value,o=>(n(),a("li",{key:o.id},[i.value&&i.value.id===o.id?(n(),a("label",ot,[b(t("input",{class:"todoList_input_edit",type:"text","onUpdate:modelValue":s[4]||(s[4]=c=>p.value=c)},null,512),[[x,p.value]])])):(n(),a("label",nt,[b(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":c=>o.status=c,onChange:c=>U(o)},null,40,at),[[q,o.status]]),t("span",null,C(o.content),1)])),i.value&&i.value.id===o.id?(n(),a("div",lt,[t("a",{href:"#",onClick:l(c=>z(o),["prevent"])},ut,8,it),t("a",{href:"#",onClick:s[5]||(s[5]=l(c=>i.value=null,["prevent"]))},dt)])):(n(),a("div",_t,[t("a",{href:"#",onClick:l(c=>S(o),["prevent"])},ft,8,vt),t("a",{href:"#",onClick:l(c=>E(o),["prevent"])},mt,8,pt)]))]))),128))]),u.value.length>0?(n(),a("div",kt,[t("p",null,C(B.value)+" 個待完成項目",1)])):$("",!0)])])])])]))}};export{Tt as default};
